<%xr_siteCall fn="fe_user::sc_redirectIfNotLoggedIn" var="checkLogin"%>
<%if !$user%>
    <%xr_siteCall fn="fe_user::getMyData" var="data"%>
    <%$user = $data['USER']%>
<%/if%>

<%$datatype='other'%>
<%if $fromRoom == 1%>
    <%$datatype='other-room'%>
<%/if%>

<%xr_img s_id=$user['wz_PROFILBILD'] var='image'%>


<%xr_img s_id=$image['new_s_id'] var='croppedImg'%>
<%xr_print_r val=$image%>
<style>
    #content {
        width: 35%;
        text-align: left;
        margin: 20px auto;
        padding: 20px 40px 40px;
        -webkit-box-shadow: 0 0 20px 0 #999;
        -moz-box-shadow: 0 0 20px 0 #999;
        box-shadow: 0 0 20px 0 #999;
    }
    #gui-container {
        width: 80%;
        text-align: center;
        margin: 0 auto;
        border: 5px solid #04e0d7;
        border-radius: 4px;
    }
    #controls {
        background-color: #1b1b1b;
        text-align: center;
    }
    #controls a {
        display: inline-block;
        padding: 0 5%;
        height: 50px;
        line-height: 50px;
        font-size: 20px;
        font-weight: 300;
        color: #888;
    }
    #data {
        display: inline-block;
        list-style: none;
        padding: 0;
        margin: 40px 0 0;
        text-align: left;
    }
    #data .column {
        display: inline-block;
        margin: 0 15px;
    }
    #data li {
        margin-bottom: 10px;
        font-weight: 700;
    }
    #data span {
        display: inline-block;
        font-weight: 400;
    }
</style>

<div id="content">
    <div id="gui-container">
        <img id="gui-image" src="/xstorage/_cache/_27808_5_9dd92562a4510d2ac773ce9d9076956d.jpg">
    </div>
    <div id="controls">
      <a href="#" id="rotate_left" title="Rotate left"><i class="fa fa-rotate-left"></i></a>
      <a href="#" id="zoom_out" title="Zoom out"><i class="fa fa-search-minus"></i></a>
      <a href="#" id="fit" title="Fit image"><i class="fa fa-arrows-alt"></i></a>
      <a href="#" id="zoom_in" title="Zoom in"><i class="fa fa-search-plus"></i></a>
      <a href="#" id="rotate_right" title="Rotate right"><i class="fa fa-rotate-right"></i></a>
    </div>
</div>
<ul id="data">
      <div class="column">
        <li>x: <span id="x">162</span></li>
        <li>y: <span id="y">92</span></li>
      </div>
      <div class="column">
        <li>width:  <span id="w">400</span></li>
        <li>height: <span id="h">300</span></li>
      </div>
      <div class="column">
        <li>scale: <span id="scale">0.2097</span></li>
        <li>angle: <span id="angle">0</span></li>
      </div>
    </ul>
</div>


<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
        <script src="/xstorage/template/plugins/guillotine/jquery.guillotine.min.js" type="text/javascript"></script>
        <script>
            $(document).ready(function() {
                
                var cropAvatar = $('#gui-image');
                
                console.log(cropAvatar.width());
                
                if(cropAvatar.width > 0) {
                    cropAvatar.guillotine({width: 345, height: 345});
                    
                    cropAvatar.on('load', function() {
                    	cropAvatar.guillotine({ eventOnChange: 'guillotinechange' })
                    	cropAvatar.guillotine('fit')
                    });
                    
                    $('#controls a').click(function(e) {
                        e.preventDefault()
                        action = camelize(this.id)
                        picture.guillotine(action)
                    })
                    
                    var camelize = function() {
                        var regex = /[\W_]+(.)/g
                        var replacer = function (match, submatch) { return submatch.toUpperCase() }
                        return function (str) { return str.replace(regex, replacer) }
                    }()
                }
            });
        </script>



